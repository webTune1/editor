<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>webTune1 Online Code Playground</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <!-- CodeMirror 6 CDN (modern, ES modules) -->
  <script type="module">
    import {EditorView, basicSetup} from "https://cdn.jsdelivr.net/npm/codemirror@6.0.1/+esm";
    import {html} from "https://cdn.jsdelivr.net/npm/@codemirror/lang-html@6.6.0/+esm";
    import {css} from "https://cdn.jsdelivr.net/npm/@codemirror/lang-css@6.2.2/+esm";
    import {javascript} from "https://cdn.jsdelivr.net/npm/@codemirror/lang-javascript@6.2.2/+esm";
    import {oneDark} from "https://cdn.jsdelivr.net/npm/@codemirror/theme-one-dark@6.2.0/+esm";
    window._codemirror6 = {EditorView, basicSetup, html, css, javascript, oneDark};
  </script>
  <style>
    :root {
      --primary: #6c63ff;
      --accent: #fdcb6e;
      --bg: #f7fafc;
      --bg-dark: #1a1b23;
      --panel: #fff;
      --panel-dark: #23243a;
      --border: #e0e0e0;
      --border-dark: #2c2c36;
      --text: #23243a;
      --text-dark: #f7fafc;
      --radius: 13px;
      --shadow: 0 2px 12px #e2e2e2a0;
    }
    body {
      font-family: 'Figtree', Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0; padding: 0;
      min-height: 100vh;
      transition: background 0.3s, color 0.3s;
    }
    body.dark {
      background: var(--bg-dark);
      color: var(--text-dark);
    }
    header {
      background: var(--primary);
      color: #fff;
      padding: 18px 0 10px 0;
      text-align: center;
      font-size: 1.45rem;
      font-weight: 800;
      letter-spacing: 1px;
      border-bottom-left-radius: 18px;
      border-bottom-right-radius: 18px;
      position: relative;
      min-height: 56px;
    }
    .theme-btn {
      position: absolute;
      top: 14px; right: 20px;
      background: #fff8;
      border: none;
      border-radius: 50%;
      width: 34px; height: 34px;
      display: flex; align-items: center; justify-content: center;
      font-size: 1.1rem;
      cursor: pointer;
      box-shadow: 0 1px 4px #bbb2;
      transition: background 0.2s;
    }
    .theme-btn:hover { background: #fff; }
    body.dark .theme-btn { background: #23243a; color: #ffe6e6;}
    .tabs {
      display: flex;
      justify-content: center;
      gap: 0;
      margin: 0 auto;
      margin-top: 10px;
    }
    .tab-btn {
      background: #f3f3ff;
      color: #23243a;
      border: none;
      border-radius: 12px 12px 0 0;
      padding: 8px 26px 7px 26px;
      margin-right: 2px;
      font-size: 1.06rem;
      font-weight: 700;
      cursor: pointer;
      border-bottom: 2.7px solid transparent;
      transition: background 0.21s, color 0.17s, border 0.17s;
    }
    .tab-btn.selected {
      background: var(--primary); color: #fff; border-bottom: 2.7px solid var(--accent);
    }
    body.dark .tab-btn { background: #23243a; color: #ffe6e6;}
    body.dark .tab-btn.selected { background: var(--accent); color: #23243a;}
    .editor-area {
      max-width: 1200px;
      margin: 0 auto;
      background: var(--panel);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1.5px solid var(--border);
      padding: 0;
      transition: background 0.3s, border 0.3s;
      min-height: 280px;
      display: flex;
      flex-direction: column;
    }
    body.dark .editor-area { background: var(--panel-dark); border: 1.5px solid var(--border-dark);}
    .editor-view { min-height: 230px; height: 230px; }
    .run-btn {
      background: var(--primary);
      color: #fff;
      font-weight: 600;
      font-size: 1.07rem;
      border: none;
      border-radius: 9px;
      padding: 9px 30px;
      margin: 20px auto 0 auto;
      display: block;
      cursor: pointer;
      transition: background 0.16s;
      box-shadow: 0 2px 12px #6c63ff15;
    }
    .run-btn:hover { background: #5248d6; }
    .preview-panel {
      max-width: 1200px;
      margin: 25px auto 0 auto;
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: 0 2px 13px #6c63ff14;
      border: 1.5px solid var(--border);
      overflow: hidden;
      transition: background 0.3s, border 0.3s;
    }
    body.dark .preview-panel { background: #23272f; border: 1.5px solid var(--border-dark);}
    .preview-title {
      font-size: 1.08rem;
      color: var(--primary);
      padding: 9px 18px 5px 18px;
      background: #f3f3ff;
      border-bottom: 1px solid var(--border);
      font-weight: 700;
      letter-spacing: 1px;
    }
    body.dark .preview-title { background: #23243a; color: #fdcb6e; border-bottom: 1px solid var(--border-dark);}
    .preview-area {
      background: #fff;
      width: 100%;
      min-height: 210px;
      border: none;
      transition: background 0.3s;
      display: block;
    }
    body.dark .preview-area { background: #181a23;}
    .tips {
      max-width: 1200px;
      margin: 22px auto 0 auto;
      padding: 14px 18px;
      background: #eaf2ff;
      border-radius: 11px;
      color: #23272f;
      font-size: 1.04rem;
      box-shadow: 0 2px 12px #e3eaff22;
    }
    body.dark .tips { background: #23243a; color: #ffe6e6;}
    .footer {
      text-align: center;
      color: #aaa;
      margin: 28px 0 12px 0;
      font-size: 1rem;
    }
    @media (max-width: 700px) {
      .editor-area, .preview-panel, .tips { max-width: 99vw; }
      .tab-btn { font-size: 0.99rem; padding: 6px 13vw 5px 13vw;}
      header { font-size: 1.13rem;}
    }
    @media (max-width: 420px) {
      .tab-btn { font-size: 0.91rem; padding: 4px 7vw;}
      .run-btn { font-size: 0.93rem; padding: 7px 7vw;}
    }
  </style>
</head>
<body>
  <header>
    webTune1 Online Code Playground
    <button class="theme-btn" id="themeBtn" title="Toggle Dark/Light"><span id="themeIcon">üåô</span></button>
  </header>
  <div class="tabs">
    <button class="tab-btn selected" id="tab-html" onclick="selectTab('html')">HTML</button>
    <button class="tab-btn" id="tab-css" onclick="selectTab('css')">CSS</button>
    <button class="tab-btn" id="tab-js" onclick="selectTab('js')">JS</button>
  </div>
  <div class="editor-area">
    <div id="editor-html" class="editor-view"></div>
    <div id="editor-css" class="editor-view" style="display:none"></div>
    <div id="editor-js" class="editor-view" style="display:none"></div>
  </div>
  <button class="run-btn" onclick="runCode()">‚ñ∂Ô∏è Run</button>
  <div class="preview-panel">
    <div class="preview-title">Live Preview</div>
    <iframe id="preview" class="preview-area" sandbox="allow-scripts allow-modals"></iframe>
  </div>
  <div class="tips">
    <b>Tips:</b>
    <ul>
      <li>Write HTML, CSS, JS in each tab. Click <b>Run</b> to see the result below.</li>
      <li>Toggle <b>üåô/üåû</b> for dark mode. Your code is saved in your browser automatically.</li>
      <li>On mobile: tap tabs to switch, double-tap code to scroll.</li>
      <li>No download or setup needed ‚Äî works anywhere, even at office!</li>
    </ul>
  </div>
  <div class="footer">
    &copy; webTune1 ‚Äì Code Playground. <br>
    Edit and save your code, anytime, anywhere!
  </div>
  <script>
    // ========== CodeMirror 6 Setup ==========
    let cm = window._codemirror6;
    let htmlEditor, cssEditor, jsEditor;
    let htmlCode = localStorage.getItem('cm6-html') || "<h1>Hello webTune1!</h1>\n<button onclick='alert(`Hi!`)'>Click me</button>";
    let cssCode = localStorage.getItem('cm6-css') || "body { font-family: 'Figtree', Arial, sans-serif; background: #f7fafc; color: #23243a; }\nh1 { color: #6c63ff; }";
    let jsCode = localStorage.getItem('cm6-js') || "console.log('Hello from JS!');";
    let curTab = 'html';
    function createEditor(id, code, lang) {
      let extensions = [cm.basicSetup];
      if (lang === 'html') extensions.push(cm.html());
      if (lang === 'css') extensions.push(cm.css());
      if (lang === 'js') extensions.push(cm.javascript());
      if (document.body.classList.contains('dark')) extensions.push(cm.oneDark);
      return new cm.EditorView({
        doc: code,
        extensions,
        parent: document.getElementById('editor-' + lang),
        dispatch: tr => {
          let view = editors[lang];
          view.update([tr]);
          if (tr.docChanged) {
            let val = view.state.doc.toString();
            if (lang === 'html') htmlCode = val;
            if (lang === 'css') cssCode = val;
            if (lang === 'js') jsCode = val;
            saveCode();
          }
        }
      });
    }
    let editors = {};
    function setupEditors() {
      if (editors.html) editors.html.destroy();
      if (editors.css) editors.css.destroy();
      if (editors.js) editors.js.destroy();
      editors.html = createEditor('editor-html', htmlCode, 'html');
      editors.css = createEditor('editor-css', cssCode, 'css');
      editors.js = createEditor('editor-js', jsCode, 'js');
    }
    function saveCode() {
      localStorage.setItem('cm6-html', htmlCode);
      localStorage.setItem('cm6-css', cssCode);
      localStorage.setItem('cm6-js', jsCode);
    }
    function selectTab(tab) {
      ['html','css','js'].forEach(lang => {
        document.getElementById('tab-'+lang).classList.remove('selected');
        document.getElementById('editor-'+lang).style.display = lang === tab ? '' : 'none';
      });
      document.getElementById('tab-'+tab).classList.add('selected');
      curTab = tab;
    }
    function runCode() {
      saveCode();
      const src = `
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Preview</title>
          <style>${cssCode}</style>
        </head>
        <body>
          ${htmlCode}
          <script>${jsCode}<\/script>
        </body>
        </html>
      `;
      document.getElementById('preview').srcdoc = src;
    }
    // Theme
    const themeBtn = document.getElementById('themeBtn');
    const themeIcon = document.getElementById('themeIcon');
    function setTheme(mode) {
      if(mode==='dark') {
        document.body.classList.add('dark');
        themeIcon.textContent = "üåû";
      } else {
        document.body.classList.remove('dark');
        themeIcon.textContent = "üåô";
      }
      setupEditors();
      localStorage.setItem('cm6-theme', mode);
    }
    themeBtn.onclick = function() {
      setTheme(document.body.classList.contains('dark')?'light':'dark');
    }
    if(localStorage.getItem('cm6-theme')==='dark') setTheme('dark');
    else setupEditors();
    setTimeout(runCode, 150);
    // Keyboard shortcut: Ctrl+Enter to run
    window.addEventListener('keydown', function(e){
      if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
        runCode();
        e.preventDefault();
      }
    });
  </script>
</body>
</html>
